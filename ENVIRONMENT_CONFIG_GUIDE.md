# é¡¹ç›®ç¯å¢ƒé…ç½®åŠŸèƒ½è¯´æ˜ï¼ˆå®Œæ•´ç‰ˆï¼‰

## åŠŸèƒ½æ¦‚è¿°
ä¸ºé¡¹ç›®è¯¦æƒ…é¡µé¢æ·»åŠ äº†å®Œæ•´çš„ç¯å¢ƒé…ç½®åŠŸèƒ½ï¼Œé‡‡ç”¨å·¦å³åˆ†æ å¸ƒå±€ï¼Œæ”¯æŒå¤šç¯å¢ƒç®¡ç†å’Œè¯¦ç»†é…ç½®ã€‚

## å…¥å£ä½ç½®

### é¡¹ç›®è¯¦æƒ…é¡µé¢
```
ç‚¹å‡»é¡¹ç›® â†’ è¿›å…¥é¡¹ç›®ç»Ÿè®¡é¡µé¢ â†’ å³ä¸Šè§’"ç¯å¢ƒé…ç½®"æŒ‰é’®
```

### æŒ‰é’®ä½ç½®
ä½äºé¡¹ç›®æ ‡é¢˜çš„å³ä¾§ï¼Œä¸"ç¼–è¾‘"ã€"åˆ é™¤"æŒ‰é’®å¹¶åˆ—ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ PAMC Exchange Platform  [âš™ï¸ç¯å¢ƒé…ç½®] [ç¼–è¾‘] [åˆ é™¤] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ç¯å¢ƒé…ç½®å¯¹è¯æ¡†

### å¯¹è¯æ¡†ç»“æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ é¡¹ç›®ç¯å¢ƒé…ç½® â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é…ç½®é¡¹ç›®çš„æµ‹è¯•ç¯å¢ƒ...        [+ æ·»åŠ ç¯å¢ƒ]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€ ç¯å¢ƒ1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ â—‹ é»˜è®¤ç¯å¢ƒ                    [åˆ é™¤] â”‚    â”‚
â”‚ â”‚ ç¯å¢ƒåç§°: [å¼€å‘ç¯å¢ƒ              ]   â”‚    â”‚
â”‚ â”‚ Base URL: [http://dev.example.com]  â”‚    â”‚
â”‚ â”‚ æè¿°:     [...                  ]   â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                            â”‚
â”‚ â”Œâ”€â”€ ç¯å¢ƒ2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ â—‹ é»˜è®¤ç¯å¢ƒ                    [åˆ é™¤] â”‚    â”‚
â”‚ â”‚ ç¯å¢ƒåç§°: [æµ‹è¯•ç¯å¢ƒ              ]   â”‚    â”‚
â”‚ â”‚ Base URL: [http://test.example.com] â”‚    â”‚
â”‚ â”‚ æè¿°:     [...                  ]   â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                          [å–æ¶ˆ] [ä¿å­˜é…ç½®]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## åŠŸèƒ½ç‰¹æ€§

### 1. å¤šç¯å¢ƒç®¡ç†
- æ”¯æŒæ·»åŠ å¤šä¸ªç¯å¢ƒé…ç½®
- æ¯ä¸ªç¯å¢ƒåŒ…å«ï¼š
  - ç¯å¢ƒåç§°ï¼ˆå¿…å¡«ï¼‰
  - Base URLï¼ˆå¿…å¡«ï¼‰
  - æè¿°ï¼ˆå¯é€‰ï¼‰
  - æ˜¯å¦é»˜è®¤ç¯å¢ƒ

### 2. é»˜è®¤ç¯å¢ƒè®¾ç½®
- ä½¿ç”¨å•é€‰æ¡†é€‰æ‹©é»˜è®¤ç¯å¢ƒ
- åªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤ç¯å¢ƒ
- ç‚¹å‡»å•é€‰æ¡†è‡ªåŠ¨åˆ‡æ¢é»˜è®¤ç¯å¢ƒ

### 3. ç¯å¢ƒå¢åˆ 
- **æ·»åŠ ç¯å¢ƒ**ï¼šç‚¹å‡»"+ æ·»åŠ ç¯å¢ƒ"æŒ‰é’®
- **åˆ é™¤ç¯å¢ƒ**ï¼šç‚¹å‡»æ¯ä¸ªç¯å¢ƒå¡ç‰‡å³ä¸Šè§’çš„"åˆ é™¤"æŒ‰é’®
- **ä¿æŠ¤æœºåˆ¶**ï¼šè‡³å°‘ä¿ç•™ä¸€ä¸ªç¯å¢ƒé…ç½®

### 4. æ•°æ®éªŒè¯
- ç¯å¢ƒåç§°ä¸èƒ½ä¸ºç©º
- Base URLä¸èƒ½ä¸ºç©º
- ä¿å­˜æ—¶è‡ªåŠ¨éªŒè¯

## æŠ€æœ¯å®ç°

### æ•°æ®ç»“æ„
```javascript
const envFormData = reactive({
  project_id: null,
  environments: [
    {
      name: 'å¼€å‘ç¯å¢ƒ',
      base_url: 'http://dev.example.com',
      description: 'å¼€å‘ç¯å¢ƒé…ç½®',
      is_default: true
    },
    {
      name: 'æµ‹è¯•ç¯å¢ƒ',
      base_url: 'http://test.example.com',
      description: 'æµ‹è¯•ç¯å¢ƒé…ç½®',
      is_default: false
    },
    {
      name: 'ç”Ÿäº§ç¯å¢ƒ',
      base_url: 'http://prod.example.com',
      description: 'ç”Ÿäº§ç¯å¢ƒé…ç½®',
      is_default: false
    }
  ]
})
```

### äº‹ä»¶å¤„ç†

#### 1. æ‰“å¼€é…ç½®å¯¹è¯æ¡†
```javascript
const handleConfigEnvironment = (project) => {
  envFormData.project_id = project.project_id
  envDialogVisible.value = true
  
  // TODO: ä»åç«¯åŠ è½½å·²æœ‰çš„ç¯å¢ƒé…ç½®
  // const response = await getProjectEnvironments(project.project_id)
  // envFormData.environments = response.data
}
```

#### 2. æ·»åŠ ç¯å¢ƒ
```javascript
const handleAddEnvironment = () => {
  envFormData.environments.push({
    name: '',
    base_url: '',
    description: '',
    is_default: false
  })
}
```

#### 3. åˆ é™¤ç¯å¢ƒ
```javascript
const handleRemoveEnvironment = (index) => {
  if (envFormData.environments.length <= 1) {
    ElMessage.warning('è‡³å°‘ä¿ç•™ä¸€ä¸ªç¯å¢ƒé…ç½®')
    return
  }
  envFormData.environments.splice(index, 1)
}
```

#### 4. è®¾ç½®é»˜è®¤ç¯å¢ƒ
```javascript
const handleSetDefaultEnvironment = (index) => {
  envFormData.environments.forEach((env, i) => {
    env.is_default = i === index
  })
}
```

#### 5. ä¿å­˜ç¯å¢ƒé…ç½®
```javascript
const handleSaveEnvironments = () => {
  // éªŒè¯è¡¨å•
  const hasEmpty = envFormData.environments.some(env => !env.name || !env.base_url)
  if (hasEmpty) {
    ElMessage.error('è¯·å¡«å†™å®Œæ•´çš„ç¯å¢ƒé…ç½®ä¿¡æ¯')
    return
  }
  
  // TODO: è°ƒç”¨åç«¯APIä¿å­˜ç¯å¢ƒé…ç½®
  // await saveProjectEnvironments(envFormData.project_id, envFormData.environments)
  
  ElMessage.success('ç¯å¢ƒé…ç½®å·²ä¿å­˜')
  envDialogVisible.value = false
}
```

## æ ·å¼è®¾è®¡

### å¯¹è¯æ¡†æ ·å¼
```css
.env-config-container {
  padding: 0;
}

.env-config-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid #e4e7ed;
}
```

### ç¯å¢ƒå¡ç‰‡æ ·å¼
```css
.env-item {
  background: #fafafa;
  border: 1px solid #e4e7ed;
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 16px;
}

.env-item-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid #e4e7ed;
}
```

### æ»šåŠ¨åŒºåŸŸæ ·å¼
```css
.env-list {
  max-height: 500px;
  overflow-y: auto;
  padding-right: 8px;
}
```

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šåˆæ¬¡é…ç½®ç¯å¢ƒ
```
1. ç‚¹å‡»é¡¹ç›®è¿›å…¥è¯¦æƒ…é¡µ
2. ç‚¹å‡»å³ä¸Šè§’"ç¯å¢ƒé…ç½®"æŒ‰é’®
3. æŸ¥çœ‹é»˜è®¤ç¯å¢ƒé…ç½®
4. ä¿®æ”¹ç¯å¢ƒåç§°å’ŒURL
5. ç‚¹å‡»"ä¿å­˜é…ç½®"
```

### åœºæ™¯2ï¼šæ·»åŠ æ–°ç¯å¢ƒ
```
1. æ‰“å¼€ç¯å¢ƒé…ç½®å¯¹è¯æ¡†
2. ç‚¹å‡»"+ æ·»åŠ ç¯å¢ƒ"
3. å¡«å†™ç¯å¢ƒåç§°ã€Base URLã€æè¿°
4. é€‰æ‹©æ˜¯å¦è®¾ä¸ºé»˜è®¤ç¯å¢ƒ
5. ä¿å­˜é…ç½®
```

### åœºæ™¯3ï¼šåˆ‡æ¢é»˜è®¤ç¯å¢ƒ
```
1. æ‰“å¼€ç¯å¢ƒé…ç½®å¯¹è¯æ¡†
2. ç‚¹å‡»è¦è®¾ä¸ºé»˜è®¤çš„ç¯å¢ƒçš„å•é€‰æ¡†
3. å…¶ä»–ç¯å¢ƒè‡ªåŠ¨å–æ¶ˆé»˜è®¤çŠ¶æ€
4. ä¿å­˜é…ç½®
```

### åœºæ™¯4ï¼šåˆ é™¤ç¯å¢ƒ
```
1. æ‰“å¼€ç¯å¢ƒé…ç½®å¯¹è¯æ¡†
2. ç‚¹å‡»ç¯å¢ƒå¡ç‰‡å³ä¸Šè§’çš„"åˆ é™¤"æŒ‰é’®
3. ç¯å¢ƒè¢«ç§»é™¤
4. ä¿å­˜é…ç½®
```

## åç«¯APIè®¾è®¡å»ºè®®

### 1. è·å–é¡¹ç›®ç¯å¢ƒé…ç½®
```
GET /projects/{project_id}/environments

Response:
{
  "code": 1,
  "msg": "success",
  "data": {
    "project_id": 1,
    "environments": [
      {
        "env_id": 1,
        "name": "å¼€å‘ç¯å¢ƒ",
        "base_url": "http://dev.example.com",
        "description": "å¼€å‘ç¯å¢ƒé…ç½®",
        "is_default": true,
        "created_at": "2024-01-01T00:00:00Z"
      }
    ]
  }
}
```

### 2. ä¿å­˜é¡¹ç›®ç¯å¢ƒé…ç½®
```
POST /projects/{project_id}/environments

Request:
{
  "environments": [
    {
      "name": "å¼€å‘ç¯å¢ƒ",
      "base_url": "http://dev.example.com",
      "description": "å¼€å‘ç¯å¢ƒé…ç½®",
      "is_default": true
    }
  ]
}

Response:
{
  "code": 1,
  "msg": "ç¯å¢ƒé…ç½®ä¿å­˜æˆåŠŸ",
  "data": null
}
```

### 3. æ›´æ–°å•ä¸ªç¯å¢ƒ
```
PUT /projects/{project_id}/environments/{env_id}

Request:
{
  "name": "å¼€å‘ç¯å¢ƒ",
  "base_url": "http://dev.example.com",
  "description": "å¼€å‘ç¯å¢ƒé…ç½®",
  "is_default": true
}
```

### 4. åˆ é™¤ç¯å¢ƒ
```
DELETE /projects/{project_id}/environments/{env_id}
```

## æ•°æ®åº“è¡¨è®¾è®¡å»ºè®®

```sql
CREATE TABLE ProjectEnvironments (
    env_id INT AUTO_INCREMENT PRIMARY KEY COMMENT 'ç¯å¢ƒID',
    project_id INT NOT NULL COMMENT 'é¡¹ç›®ID',
    name VARCHAR(100) NOT NULL COMMENT 'ç¯å¢ƒåç§°',
    base_url VARCHAR(255) NOT NULL COMMENT 'åŸºç¡€URL',
    description TEXT COMMENT 'ç¯å¢ƒæè¿°',
    is_default BOOLEAN DEFAULT FALSE COMMENT 'æ˜¯å¦é»˜è®¤ç¯å¢ƒ',
    headers JSON COMMENT 'å…¨å±€è¯·æ±‚å¤´',
    variables JSON COMMENT 'ç¯å¢ƒå˜é‡',
    auth_config JSON COMMENT 'è®¤è¯é…ç½®',
    created_by INT NOT NULL COMMENT 'åˆ›å»ºäººID',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    is_deleted BOOLEAN DEFAULT FALSE,
    
    INDEX idx_project_id (project_id),
    INDEX idx_is_default (is_default)
) COMMENT='é¡¹ç›®ç¯å¢ƒé…ç½®è¡¨';
```

## åŠŸèƒ½æ‰©å±•

### å·²å®ç°åŠŸèƒ½
- [x] ç¯å¢ƒé…ç½®æŒ‰é’®ï¼ˆä»…åœ¨é¡¹ç›®çº§åˆ«æ˜¾ç¤ºï¼‰
- [x] ç¯å¢ƒé…ç½®å¯¹è¯æ¡†
- [x] æ·»åŠ ç¯å¢ƒ
- [x] åˆ é™¤ç¯å¢ƒ
- [x] è®¾ç½®é»˜è®¤ç¯å¢ƒ
- [x] ç¯å¢ƒä¿¡æ¯ç¼–è¾‘
- [x] è¡¨å•éªŒè¯

### å¾…å®ç°åŠŸèƒ½
- [ ] ä»åç«¯åŠ è½½ç¯å¢ƒé…ç½®
- [ ] ä¿å­˜ç¯å¢ƒé…ç½®åˆ°åç«¯
- [ ] ç¯å¢ƒå˜é‡ç®¡ç†
- [ ] å…¨å±€è¯·æ±‚å¤´é…ç½®
- [ ] ç¯å¢ƒè®¤è¯é…ç½®
- [ ] ç¯å¢ƒå¿«é€Ÿåˆ‡æ¢
- [ ] ç¯å¢ƒæµ‹è¯•è¿é€šæ€§
- [ ] ç¯å¢ƒé…ç½®å¯¼å…¥å¯¼å‡º
- [ ] ç¯å¢ƒé…ç½®æ¨¡æ¿

## ä½¿ç”¨æµç¨‹

### é…ç½®æµç¨‹
```
é¡¹ç›®è¯¦æƒ… 
  â†’ ç‚¹å‡»"ç¯å¢ƒé…ç½®" 
  â†’ æ‰“å¼€é…ç½®å¯¹è¯æ¡† 
  â†’ æ·»åŠ /ç¼–è¾‘/åˆ é™¤ç¯å¢ƒ 
  â†’ è®¾ç½®é»˜è®¤ç¯å¢ƒ 
  â†’ ä¿å­˜é…ç½®
```

### ä½¿ç”¨æµç¨‹
```
æ‰§è¡Œæµ‹è¯• 
  â†’ é€‰æ‹©ç¯å¢ƒ 
  â†’ ä½¿ç”¨è¯¥ç¯å¢ƒçš„Base URL 
  â†’ æ‰§è¡Œæµ‹è¯• 
  â†’ è®°å½•æ‰§è¡Œç¯å¢ƒ
```

## æ³¨æ„äº‹é¡¹

1. **è‡³å°‘ä¸€ä¸ªç¯å¢ƒ**ï¼šç³»ç»Ÿå¼ºåˆ¶è¦æ±‚è‡³å°‘ä¿ç•™ä¸€ä¸ªç¯å¢ƒé…ç½®
2. **é»˜è®¤ç¯å¢ƒå”¯ä¸€**ï¼šåªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤ç¯å¢ƒ
3. **URLæ ¼å¼éªŒè¯**ï¼šå»ºè®®æ·»åŠ URLæ ¼å¼éªŒè¯
4. **ç¯å¢ƒåˆ‡æ¢**ï¼šæ‰§è¡Œæµ‹è¯•æ—¶åº”æ˜¾ç¤ºå½“å‰ä½¿ç”¨çš„ç¯å¢ƒ
5. **å†å²è®°å½•**ï¼šæµ‹è¯•å†å²åº”è®°å½•ä½¿ç”¨çš„ç¯å¢ƒä¿¡æ¯

## åç»­ä¼˜åŒ–å»ºè®®

1. **ç¯å¢ƒå˜é‡**ï¼šæ”¯æŒåœ¨ç¯å¢ƒä¸­é…ç½®å˜é‡ï¼ˆå¦‚ï¼š{{API_KEY}}ï¼‰
2. **è¯·æ±‚å¤´é…ç½®**ï¼šæ”¯æŒä¸ºæ¯ä¸ªç¯å¢ƒé…ç½®å…¨å±€è¯·æ±‚å¤´
3. **è®¤è¯é…ç½®**ï¼šæ”¯æŒä¸åŒç¯å¢ƒçš„è®¤è¯æ–¹å¼
4. **è¿é€šæ€§æµ‹è¯•**ï¼šæ·»åŠ "æµ‹è¯•è¿æ¥"æŒ‰é’®éªŒè¯ç¯å¢ƒå¯ç”¨æ€§
5. **ç¯å¢ƒå¤åˆ¶**ï¼šæ”¯æŒä»ç°æœ‰ç¯å¢ƒå¤åˆ¶é…ç½®
6. **æ‰¹é‡å¯¼å…¥**ï¼šæ”¯æŒæ‰¹é‡å¯¼å…¥ç¯å¢ƒé…ç½®
7. **ç¯å¢ƒåˆ†ç»„**ï¼šæ”¯æŒç¯å¢ƒåˆ†ç»„ç®¡ç†
8. **å¿«é€Ÿåˆ‡æ¢**ï¼šåœ¨æ‰§è¡Œæµ‹è¯•æ—¶å¿«é€Ÿåˆ‡æ¢ç¯å¢ƒ
